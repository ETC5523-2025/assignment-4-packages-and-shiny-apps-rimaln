---
title: "Introduction to neonNitrate"
author: "Rimlan Lora Alva"
date: "5 November 2025"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to neonNitrate}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r, include = FALSE}
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.width = 7,
fig.height = 5,
warning = FALSE,
message = FALSE
)
```


## Introduction

The `neonNitrate` package provides a comprehensive set of tools to analyze and visualize surface water nitrate data from NEON sites in Germany. This vignette introduces the key functions, interactive features, and included datasets for environmental monitoring and research.

### Why Nitrate?

Nitrate levels are a crucial indicator for assessing nutrient pollution and water quality. High concentrations can impact ecosystem health and human populations relying on those water resources. 

### About the Data

The package includes processed data products to facilitate a wide range of analyses:

- **neon_nitrate**: Full nitrate time series with site metadata.
- **nitrate_clean**: Cleaned subset of nitrate samples.
- **nitrate_sample_distribution**: Sampling snapshot (counts per site/period).
- **pop_est**: Population or site aggregation estimates (if relevant).
- **strata_summary**: Stratified (by group/category) summary statistics.

## Installation

To install the latest version:

```{r}
install.packages("neonNitrate")

```


## Loading neonNitrate

```{r}
library(neonNitrate)
library(ggplot2)

```

## Exploring Package Datasets

### 1. Nitrate Sample Distribution

A snapshot of sampling effort per site:

```{r}
data("neon_nitrate", package = "neonNitrate")

data("nitrate_sample_distribution", package = "neonNitrate")

```


*Key variables:*  
- `site`, `n_samples` (or your actual variable names)

### 2. Full Nitrate Dataset

Complete time series with measurement detail:

```{r}
head(neon_nitrate)
head(nitrate_sample_distribution)

```


### 3. Stratified Summary

For more detailed analysis by group:

```{r}
data(strata_summary)
head(strata_summary)
```


## Using the Interactive Dashboard

To launch the interactive Shiny dashboard:

```{r}
run_app()
```


*If you see "Could not locate Shiny app directory," ensure your app is in `inst/app/` and referenced correctly in `run_app()`.*

## Basic Data Visualization

### Count of Samples by Site
```{r}
ggplot(nitrate_sample_distribution, aes(x = site, y = n_samples)) +
geom_col(fill = "#009E73") +
labs(
title = "Samples Collected per NEON Site",
x = "Site",
y = "Sample Count"
) +
theme_minimal()
```



###  Analysis: Median Nitrate by Site

```{r}
library(dplyr)

neon_nitrate  |> 
group_by(site)  |> 
summarise(median_nitrate = median(nitrate_concentration, na.rm=TRUE)) %>%
arrange(desc(median_nitrate))

```


### Time Series Plot

```{r}
ggplot(neon_nitrate, 
aes(x = date, 
y = nitrate_concentration,
color = site)) +
geom_line() +
labs(title = "Temporal Patterns in Nitrate Concentration",
x = "Date", y = "Nitrate (mg/L)") +
theme_minimal()

```



## Best Practices

- Use the dashboard to explore interactive plots and summary statistics.
- Rely on grouped summaries to compare across sites/timeframes.
- Check for missing data and outliers before modeling.
- Use confidence intervals if you perform any statistical estimation.

## Next Steps

1. Try further data wrangling with dplyr or tidyr if needed.
2. Document your analyses with exported visuals and tables.
3. Explore each function with the help system, e.g. `?run_app`.

## References

- National Ecological Observatory Network (NEON): https://www.neonscience.org
- For nitrate research background: [Any key paper or citation required for your work]

## Getting Help

- **Package documentation**: `?neonNitrate`
- **Function help**: `?run_app`
- **Dataset help**: `?nitrate_sample_distribution`, `?neon_nitrate`

